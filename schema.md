# 讯盟前端监控平台

## 初步思路

> 本着减少服务压力的初衷，去除 pv，保留 uv；捕获全部，只上报异常事件；关于异常的定义还需要待考量。

### SDK 侧

需要捕获的内容：

- 页面相关的时间
- 资源加载的清单、时间
- 接口加载的清单、时间
- Js `Error` 细分

除此之外，还要

- 标记用户设备信息
- 划分日志等级
- 标记事件唯一ID（同一错误发生了多少次）
- 记录事件的行为轨迹，先点的哪个、再点的哪个、最后报错的复现路径

### 服务收集 侧

用户系统、应用系统。

不同的用户可以登录进来创建不同的应用 ID，sdk 侧 通过应用 ID 可以知道是哪个应用、哪个人。

### 数据分析 侧

 -

### 管理后台

用户系统使用统一登录 `uban360`，与讯盟文档一致。

#### 用户与项目管理

- 用户可以创建很多项目
- 也可以加入其它用户，被加入的人权限和创建者一致
- 用户登录进来后看到项目列表

#### 项目详情

项目详情下都是事件错误日志列表，点击单个错误日志，展示日志详情

- 基础信息
  - 时间
  - 错误类型
  - 标题
  - url
- 堆栈信息 
- 设备信息
  - 浏览器
  - 版本
  - 操作系统
  - 网络情况
  - 设备名称
- 位置信息
- sdk 版本
- 复现路径

每个事件有状态

- 已产生
- 谁跟进中
- 谁已解决

## 表结构、前端数据结构

- 

### 参考要点

```
章节1:前端监控架构设计
课时1为什么要做前端监控？04:42
课时2前端监控什么数据？03:50
课时3前端监控架构设计02:53
章节2:编写监控采集脚本
课时4设计监控上报数据模型06:09
课时5开通SLS日志服务02:39
课时6如何通过webTrack上报数据？07:15
课时7JS错误和资源采集02:38
课时8接口错误采集03:11
课时9白屏错误统计方法和代码03:53
课时10页面加载时间计算方法和代码实现03:15
课时11FP/FCP/FMP/FID时间原理介绍02:22
课时12FP/FCP/FMP/FID时间代码实现03:02
课时13卡顿原理和采集代码实现02:01
课时14TBT体验指标计算原理01:58
课时15PV和自定义指标采集01:31
章节3:数据分析大盘
课时16如何做数据查询和可视化06:50
课时17搭建可视化数据大盘03:15
课时18参数化数据查询与大盘构建
章节4:数据监控告警
课时19监控和告警的区别04:43
课时20设置JS同步增长告警05:32
课时21告警准确性问题
```

### 参考资料

- [performance](https://juejin.im/post/5d66655a5188256c3920b35d#heading-30)
- [贝壳灯塔](https://github.com/LianjiaTech/fee)
- [学习 sentry 源码整体架构](https://juejin.im/post/5dba5a39e51d452a2378348a)
- [zanePerfor](https://github.com/wangweianger/zanePerfor/tree/master/app)
- [FunDebug](https://www.fundebug.com/)

